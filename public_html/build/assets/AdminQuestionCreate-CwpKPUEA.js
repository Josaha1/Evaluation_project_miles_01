import{K as j,m as k,r as c,j as e}from"./app-DQ2VkJ7f.js";import{t as x,M as _}from"./MainLayout-BTc9pcGZ.js";import{B as N}from"./breadcrumb-D7MOHieF.js";import"./Footer-TA0Z8X7z.js";import"./utils-ONoQxm8A.js";function E(){const{evaluation:o,part:d,aspects:u,subaspects:m=[],selectedAspect:h,selectedSub:b,flash:l}=j().props,{data:a,setData:s,post:g,processing:v}=k({aspect_id:h??"",sub_aspect_id:b??"",title:"",type:"rating",options:[{label:"",score:5}]}),[y,p]=c.useState(!1);c.useEffect(()=>{l.success&&x.success(l.success),l.error&&x.error(l.error),a.type==="open_text"?s("options",[]):a.options.length===0&&s("options",[{label:"",score:a.type==="rating"?5:null}])},[l,a.type]),c.useEffect(()=>{const t=u.find(r=>r.id===Number(a.aspect_id));t!=null&&t.has_subaspects?p(!0):(p(!1),s("sub_aspect_id",""))},[a.aspect_id]);const f=t=>{t.preventDefault();const r={...a};a.type==="open_text"&&delete r.options,g(route("questions.store",{evaluation:o.id,part:d.id}),{preserveScroll:!0,data:r})};return e.jsx(_,{title:"เพิ่มคำถาม",breadcrumb:e.jsx(N,{items:[{label:"แดชบอร์ดผู้ดูแลระบบ",href:route("admindashboard")},{label:"รายการแบบประเมิน",href:route("evaluations.index")},{label:o.title,href:route("evaluations.edit",{evaluation:o.id})},{label:d.title,href:route("aspects.index",{evaluation:o.id,part:d.id})},{label:"เพิ่มคำถาม",active:!0}]}),children:e.jsx("div",{className:"max-w-3xl mx-auto py-10",children:e.jsxs("form",{onSubmit:f,className:"space-y-6 bg-white dark:bg-gray-800 p-6 rounded shadow",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"เลือกด้าน"}),e.jsxs("select",{autoFocus:!0,className:"w-full border p-2 rounded  text-black  dark:text-white dark:bg-gray-700",value:a.aspect_id,onChange:t=>s("aspect_id",t.target.value),required:!0,children:[e.jsx("option",{value:"",children:"-- เลือกด้าน --"}),u.map(t=>e.jsxs("option",{value:t.id,children:[t.name," ",t.has_subaspects?"(มีด้านย่อย)":""]},t.id))]})]}),y&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"เลือกด้านย่อย"}),e.jsxs("select",{className:"w-full mt-1 border p-2 rounded dark:bg-gray-700 dark:text-white",value:a.sub_aspect_id,onChange:t=>s("sub_aspect_id",t.target.value),required:!0,children:[e.jsx("option",{value:"",children:"-- เลือกด้านย่อย --"}),m.filter(t=>t.aspect_id===Number(a.aspect_id)).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"คำถาม"}),e.jsx("input",{type:"text",className:"w-full mt-1 border p-2 rounded dark:bg-gray-700 dark:text-white",value:a.title,onChange:t=>s("title",t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"ประเภทคำถาม"}),e.jsxs("select",{className:"w-full mt-1 border p-2 rounded dark:bg-gray-700 dark:text-white",value:a.type,onChange:t=>s("type",t.target.value),required:!0,children:[e.jsx("option",{value:"rating",children:"Rating"}),e.jsx("option",{value:"multiple_choice",children:"Multiple Choice"}),e.jsx("option",{value:"choice",children:"Choice"}),e.jsx("option",{value:"open_text",children:"Open Text"})]})]}),a.type!=="open_text"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"ตัวเลือก"}),a.options.map((t,r)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:`ตัวเลือกที่ ${r+1}`,value:t.label,onChange:n=>{const i=[...a.options];i[r].label=n.target.value,s("options",i)},className:"flex-1 border p-2 rounded dark:bg-gray-700 dark:text-white"}),a.type==="rating"&&e.jsx("input",{type:"number",placeholder:"คะแนน",value:t.score??"",onChange:n=>{const i=[...a.options];i[r].score=parseInt(n.target.value),s("options",i)},className:"w-24 border p-2 rounded dark:bg-gray-700 dark:text-white"})]},r)),e.jsx("button",{type:"button",onClick:()=>s("options",[...a.options,{label:"",...a.type==="rating"?{score:1}:{}}]),className:"text-sm text-blue-600",children:"➕ เพิ่มตัวเลือก"})]}),e.jsx("div",{className:"text-right",children:e.jsx("button",{type:"submit",disabled:v,className:"bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700",children:"บันทึกคำถาม"})})]})})})}export{E as default};
