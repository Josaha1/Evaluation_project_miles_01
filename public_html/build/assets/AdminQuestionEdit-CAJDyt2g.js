import{K as y,m as f,r as u,j as e}from"./app-DQ2VkJ7f.js";import{t as m,M as _}from"./MainLayout-BTc9pcGZ.js";import{B as k}from"./breadcrumb-D7MOHieF.js";import"./Footer-TA0Z8X7z.js";import"./utils-ONoQxm8A.js";function S(){const{evaluation:o,part:n,aspects:p,subaspects:h=[],question:r,flash:l}=y().props,{data:a,setData:s,put:b,processing:g}=f({aspect_id:r.aspect_id??"",sub_aspect_id:r.sub_aspect_id??"",title:r.title??"",type:r.type??"rating",options:r.options??[]}),[v,x]=u.useState(!!r.sub_aspect_id);u.useEffect(()=>{l.success&&m.success(l.success),l.error&&m.error(l.error)},[l]),u.useEffect(()=>{const t=p.find(i=>i.id===Number(a.aspect_id));t!=null&&t.has_subaspects?x(!0):(x(!1),s("sub_aspect_id",""))},[a.aspect_id]);const j=t=>{t.preventDefault(),b(route("questions.update",{evaluation:o.id,part:n.id,question:r.id}))};return e.jsx(_,{title:"แก้ไขคำถาม",breadcrumb:e.jsx(k,{items:[{label:"แดชบอร์ดผู้ดูแลระบบ",href:route("admindashboard")},{label:"รายการแบบประเมิน",href:route("evaluations.index")},{label:o.title,href:route("evaluations.edit",{evaluation:o.id})},{label:n.title,href:route("aspects.index",{evaluation:o.id,part:n.id})},{label:"แก้ไขคำถาม",active:!0}]}),children:e.jsx("div",{className:"max-w-3xl mx-auto py-10",children:e.jsxs("form",{onSubmit:j,className:"space-y-6 bg-white dark:bg-gray-800 p-6 rounded shadow",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"เลือกด้าน"}),e.jsxs("select",{className:"w-full mt-1 border p-2 rounded dark:bg-gray-700 dark:text-white",value:a.aspect_id,onChange:t=>s("aspect_id",t.target.value),required:!0,children:[e.jsx("option",{value:"",children:"-- เลือกด้าน --"}),p.map(t=>e.jsxs("option",{value:t.id,children:[t.name," ",t.has_subaspects?"(มีด้านย่อย)":""]},t.id))]})]}),v&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"เลือกด้านย่อย"}),e.jsxs("select",{className:"w-full mt-1 border p-2 rounded dark:bg-gray-700 dark:text-white",value:a.sub_aspect_id,onChange:t=>s("sub_aspect_id",t.target.value),required:!0,children:[e.jsx("option",{value:"",children:"-- เลือกด้านย่อย --"}),h.filter(t=>t.aspect_id===Number(a.aspect_id)).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"คำถาม"}),e.jsx("input",{type:"text",className:"w-full mt-1 border p-2 rounded dark:bg-gray-700 dark:text-white",value:a.title,onChange:t=>s("title",t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"ประเภทคำถาม"}),e.jsxs("select",{className:"w-full mt-1 border p-2 rounded dark:bg-gray-700 dark:text-white",value:a.type,onChange:t=>s("type",t.target.value),required:!0,children:[e.jsx("option",{value:"rating",children:"Rating"}),e.jsx("option",{value:"multiple_choice",children:"Multiple Choice"}),e.jsx("option",{value:"choice",children:"Choice"}),e.jsx("option",{value:"open_text",children:"Open Text"})]})]}),a.type!=="open_text"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"ตัวเลือก"}),a.options.map((t,i)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:`ตัวเลือกที่ ${i+1}`,value:t.label,onChange:c=>{const d=[...a.options];d[i].label=c.target.value,s("options",d)},className:"flex-1 border p-2 rounded dark:bg-gray-700 dark:text-white"}),a.type==="rating"&&e.jsx("input",{type:"number",placeholder:"คะแนน",value:t.score??"",onChange:c=>{const d=[...a.options];d[i].score=parseInt(c.target.value),s("options",d)},className:"w-24 border p-2 rounded dark:bg-gray-700 dark:text-white"})]},i)),e.jsx("button",{type:"button",onClick:()=>s("options",[...a.options,{label:"",...a.type==="rating"?{score:1}:{}}]),className:"text-sm text-blue-600",children:"➕ เพิ่มตัวเลือก"})]}),e.jsx("div",{className:"text-right",children:e.jsx("button",{type:"submit",disabled:g,className:"bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700",children:"บันทึกการเปลี่ยนแปลง"})})]})})})}export{S as default};
