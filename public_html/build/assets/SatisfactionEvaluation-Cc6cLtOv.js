import{K as L,r as d,j as e,L as F,S as j}from"./app-DM3CWPwz.js";import{M}from"./MainLayout-yPW0h5_m.js";import{A as O}from"./arrow-left-L5hVJ2YX.js";import{M as p}from"./message-circle-CL7GViZ2.js";import{F as Q}from"./file-text-CLr-zjhH.js";import{S as N}from"./star-D-7M-K8n.js";import{U as A}from"./user-Cq3tEQKy.js";import{S as R}from"./send-CExb7qFm.js";import"./utils-ONoQxm8A.js";import"./x--rbPaS5b.js";const J=({evaluation:m,questions:x,ratingScale:v,fiscalYear:u,user:y})=>{const{errors:b,flash:i}=L().props,[a,w]=d.useState({}),[h,S]=d.useState(""),[c,g]=d.useState(!1),[f,n]=d.useState("");d.useEffect(()=>{i!=null&&i.error&&n(i.error),Object.keys(b||{}).length>0&&n("กรุณาตรวจสอบข้อมูลที่กรอก")},[b,i]);const C=(s,t)=>{w(r=>({...r,[s]:t}))},k=s=>{if(s.preventDefault(),n(""),g(!0),Object.keys(x).filter(l=>!a[l]).length>0){n("กรุณาให้คะแนนทุกข้อคำถาม"),g(!1);return}j.post(`/satisfaction-evaluation/${m.id}`,{...a,additional_comments:h,fiscal_year:u},{onSuccess:()=>{},onError:l=>{console.log("Submission errors:",l),typeof l=="object"&&l.message?n(l.message):n(typeof l=="string"?l:"เกิดข้อผิดพลาดในการบันทึกข้อมูล")},onFinish:()=>{g(!1)}})},o=()=>{const s=Object.keys(x).length,t=Object.keys(a).length;return Math.round(t/s*100)},$=s=>{switch(s){case 5:return"text-green-500";case 4:return"text-blue-500";case 3:return"text-yellow-500";case 2:return"text-orange-500";case 1:return"text-red-500";default:return"text-gray-400"}},E=(s,t)=>e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(r=>e.jsx("button",{type:"button",onClick:()=>C(s,r),className:`p-1 rounded-full hover:bg-gray-100 transition-colors ${r<=t?"text-yellow-400":"text-gray-300"}`,disabled:c,children:e.jsx(N,{className:`w-8 h-8 ${r<=t?"fill-current":""}`})},r))});return e.jsxs(M,{children:[e.jsx(F,{title:`ประเมินความพึงพอใจ - ${m.title}`}),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("button",{onClick:()=>j.visit("/dashboard"),className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(O,{className:"w-5 h-5"})}),e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:e.jsx(p,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"แบบประเมินความพึงพอใจ"}),e.jsxs("p",{className:"text-gray-600",children:[m.title," - ปีงบประมาณ ",u]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"ความคืบหน้า"}),e.jsxs("span",{className:"text-sm font-semibold text-blue-600",children:[o(),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all duration-300",style:{width:`${o()}%`}})})]}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Q,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-1",children:"คำแนะนำในการประเมิน"}),e.jsx("p",{className:"text-blue-800 text-sm",children:"กรุณาให้คะแนนความพึงพอใจในแต่ละข้อคำถาม โดยใช้เกณฑ์ 1-5 ดาว (1 = พึงพอใจน้อยที่สุด, 5 = พึงพอใจมากที่สุด)"})]})]})})]}),e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5 text-yellow-400"}),"คำถามการประเมินความพึงพอใจ"]}),e.jsx("div",{className:"space-y-8",children:Object.entries(x).map(([s,t],r)=>e.jsx("div",{className:"border-b border-gray-100 pb-6 last:border-b-0",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:r+1})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:t}),e.jsxs("div",{className:"flex items-center gap-4",children:[E(s,a[s]||0),a[s]&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-semibold ${$(a[s])}`,children:a[s]}),e.jsxs("span",{className:"text-sm text-gray-600",children:["(",v[a[s]],")"]})]})]})]})]})},s))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(p,{className:"w-5 h-5 text-green-500"}),"ความคิดเห็นเพิ่มเติม (ไม่บังคับ)"]}),e.jsx("textarea",{value:h,onChange:s=>S(s.target.value),placeholder:"กรุณาแสดงความคิดเห็นเพิ่มเติมเกี่ยวกับระบบประเมิน...",className:"w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:4,maxLength:1e3,disabled:c}),e.jsxs("div",{className:"text-right text-sm text-gray-500 mt-2",children:[h.length,"/1000 ตัวอักษร"]})]}),f&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs",children:"!"})}),e.jsx("p",{className:"text-red-700 font-medium",children:f})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(A,{className:"w-5 h-5"}),e.jsxs("span",{children:["ผู้ประเมิน: ",y.name]})]}),e.jsx("button",{type:"submit",disabled:c||o()<100,className:`flex items-center gap-2 px-6 py-3 rounded-lg font-semibold transition-all ${c||o()<100?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-blue-500 to-purple-500 text-white hover:shadow-lg transform hover:scale-105"}`,children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"กำลังบันทึก..."]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"w-5 h-5"}),"ส่งการประเมิน"]})})]})})]})]})})]})};export{J as default};
